<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>FriendFinder</title>

	<!-- Latest compiled and minified CSS & JS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery.js"></script>

	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

	<!-- Font Awesome Glyphicons -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">

	<!-- Chosen -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
	<!-- <script src="java.js"></script> -->
	<style type="text/css">
			.move{
				margin-left: 130px;
				font-size: 24px;
				font-weight: bold;
			}
			.move2{
				margin-left: 107px;
				font-size: 24px;
				font-weight: bold;
			}
	</style>
</head>
<body>

	<div class="container entire">

		<h2 id="h2-survey">Survey Questions</h2>
		<hr>

		<h3 id="h3-about"><strong>About You</strong></h3>
		<h4 id="h4-name">Name (Required)</h4>
	<div id="compatable">
		<input type="text" name="" id="name" class="form-control" required >

		<h4>Link to Photo Image (Required)</h4>
		<input type="text" name="" id="photo" class="form-control" required >

		<h3><strong>Gender</strong></h3>
		<!-- <h4>Your mind is always buzzing with unexplored ideas and plans.</h4>--> 
	 	<select data-placeholder="" class="gender-select" id="gender">	
            <option value="1">Male</option>
            <option value="2">Female</option>
      	</select>

		<hr>

		<h3><strong>Question 1</strong></h3>
		<h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
	 	<select data-placeholder="" class="chosen-select" id="q1">
	 		<option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
      	</select>

		<h3><strong>Question 2</strong></h3>
		<h4>Generally speaking, you rely more on your experience than your imagination.</h4>
	 	<select data-placeholder="" class="chosen-select" id="q2">
	 		<option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
      	</select>


		<h3><strong>Question 3</strong></h3>
		<h4>You find it easy to stay relaxed and focused even when there is some pressure.</h4>
	 	<select data-placeholder="" class="chosen-select" id="q3">
	 		<option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
      	</select>


		<h3><strong>Question 4</strong></h3>
		<h4>You rarely do something just out of sheer curiosity.</h4>
	 	<select data-placeholder="" class="chosen-select" id="q4">
	 		<option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
      	</select>


		<h3><strong>Question 5</strong></h3>
		<h4>People can rarely upset you.</h4>
	 	<select data-placeholder="" class="chosen-select" id="q5">
	 		<option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
      	</select>


		<h3><strong>Question 6</strong></h3>
		<h4>It is often difficult for you to relate to other people’s feelings.</h4>
	 	<select data-placeholder="" class="chosen-select" id="q6">
	 		<option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
      	</select>


		<h3><strong>Question 7</strong></h3>
		<h4>In a discussion, truth should be more important than people’s sensitivities.</h4>
	 	<select data-placeholder="" class="chosen-select" id="q7">
	 		<option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
      	</select>

		<h3><strong>Question 8</strong></h3>
		<h4>You rarely get carried away by fantasies and ideas.</h4>
	 	<select data-placeholder="" class="chosen-select" id="q8">
	 		<option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
      	</select>

		<h3><strong>Question 9</strong></h3>
		<h4>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</h4>
	 	<select data-placeholder="" class="chosen-select" id="q9">
	 		<option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
      	</select>

		<h3><strong>Question 10</strong></h3>
		<h4>You feel more energetic after spending time with a group of people.</h4>
	 	<select data-placeholder="" class="chosen-select" id="q10">
	 		<option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
      	</select>

		<br>
		<br>
		<!-- Submit Button -->
		<button type="submit" class="btn btn-primary btn-lg btn-block" id="submit"><i class="fa fa-check-circle" aria-hidden="true"></i>
 Submit</button>
</div>
		<hr>
	<div id="reset"></div><br>
	    <footer class="footer">
	      <div class="container">
		        <p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/afhaque/friendfinder">GitHub Repo</a></p>
	      </div>
	    </footer>

	</div>

	<!-- Modal -->
	<div id="resultsModal" class="modal fade" role="dialog">
	  <div class="modal-dialog">

	    <!-- Modal content-->
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal">&times;</button>
	        <h2 class="modal-title"><strong>Best Match</strong></h2>
	      </div>
	      <div class="modal-body">
	        <h2 id="matchName"></h2>
	        <h3 id="compatable-match"></h3>
	        <img id="matchImg" src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/p/6/005/064/1bd/3435aa3.jpg" alt="">
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	      </div>
	    </div>

	  </div>
	</div>


</body>
<script type="text/javascript">
  	// Chosen CSS
    var config = {
      '.chosen-select'           : {},
      '.chosen-select-deselect'  : {allow_single_deselect:true},
      '.chosen-select-no-single' : {disable_search_threshold:10},
      '.chosen-select-no-results': {no_results_text:'Oops, nothing found!'},
      '.chosen-select-width'     : {width:"95%"}
    }
    
    for (var selector in config) {
      $(selector).chosen(config[selector]);
    }

var gender= $("#gender").val();


    // Capture the form inputs 
    $("#submit").on("click", function(){
	var reset = $("<button>");
		reset.addClass("btn btn-primary btn-lg btn-block")
	 reset.text("Reset");
	reset.css("margin-top", "23px")
	 $("#reset").append(reset);
    	// Form validation
    	function Submit() {
		  var isValid = true;
		  $('.form-control').each(function() {
		    if ( $(this).val() === '' )
		        isValid = false;
		  });

		  $('.chosen-select').each(function() {

		  	if( $(this).val() === "")
		  		isValid = false
		  		 })
		  	
		  return isValid;
		}

		// If all required fields are filled
		if (Submit() == true){
			console.log("bbbb")
			// Create an object for the user's data
	    	var userData = {
	    		name: $("#name").val(),
	    		photo: $("#photo").val(),
	    		gender:$("#gender").val(),
	    		scores: [$("#q1").val(), $("#q2").val(), $("#q3").val(), $("#q4").val(), $("#q5").val(), $("#q6").val(), $("#q7").val(), $("#q8").val(), $("#q9").val(), $("#q10").val(), ]
	    	}


	    	// Grab the URL of the website
	    	var currentURL = window.location.origin;
	    	//var url = currentURL + "/api/:gender";
				console.log(typeof userData.gender)				    	// AJAX post the data to the friends API. 
					

console.log(userData.gender)
if(userData.gender==1){
			$.ajax({
				   url: currentURL + "/api/friends/girl",
			       method: "GET",
				   context: userData
				   }).done(function(friends){
					   var meArray = userData.scores;
					   var total=0;
							for(i=0;i<userData.scores.length;i++) { 
								total += parseInt(userData.scores[i]); 
							    userData.total=parseInt(total);								             
						    }
		 												//console.log(userData.total)	
							for(i=0; i<friends.length;i++){
								friends[i].sum= friends[i].scores[0]+friends[i].scores[1]+friends[i].scores[2]+friends[i].scores[3]+friends[i].scores[4]+friends[i].scores[5]+friends[i].scores[6]+friends[i].scores[7]+friends[i].scores[8]+friends[i].scores[9];

        						 friends[i].difference= userData.total-friends[i].sum;
         							//console.log(userData.total)
                                 	//console.log(friends[0].sum)
                                    //console.log(friends[0].difference)

							              if(friends[i].difference<0){
							                  friends[i].difference= friends[i].difference * -1;
							              }
							              else{
							                  friends[i].difference= friends[i].difference
							              }
							             
							 
							             }   
						             		   friends.sort(function(a, b) {
						              		   return parseFloat(b.difference) - parseFloat(a.difference);
						                        });

						   						$("#matchImg").attr("src",friends[0].photo);
						   						$("#matchName").text(friends[0].name)
						   						//$("#compatable-match").text(friends[0].percentage)
						   						$("#resultsModal").modal("toggle")
						   			// 		    $("#h3-about").html(" ");
						   			// 			$("#h4-name").html(" ");
						   			// 			$("#h2-survey").css("text-align","center")
						   			// 			$("#h2-survey").html(userData.name +" here is who you are most compatable with");
						      //                   console.log(friends);

						      //                   $(".entire").css("background-color","lightblue");
						      //                   $(".entire").css("border","3px solid black");
						      //                   $("#compatable").css("font-weight","bold");
						      //                   $("#compatable").css("font-family","cursive");
						      //                   $("#compatable").css("font-size","24px");
						                        
						      //                   $("#h2-survey").css("font-weight","bold");
						      //                   $("#h2-survey").css("font-family","cursive");
						      //                   $("#h2-survey").css("font-size","24px");
						      //                   $("#compatable").empty()
						                        
						      //                   for(i=0;i<friends.length;i++){
						      //                   	friends[i].percentage = parseInt(((friends[i].difference)/50)*100) + "%";
						      //                   	console.log(friends[i].percentage)
						      //                   	var a = $("<img>");
						      //                   		a.attr("src", friends[i].photo)
						      //                   		a.css("width", "330");
						      //                   		a.css("height", "330")
						      //                   		a.css("margin", "20px");
						      //                   		a.css("border","3px solid black")

												// var b= $("<div>");
											 //    b.html("<div class= 'move'>"+ "*** " +friends[i].name+" ***" +"</div> <br>" +"<div class= 'move2'>"+ friends[i].percentage+" compatable" +"</div>");
												// console.log(b);
												// b.append(a)
												// $("#compatable").css("display","flex")
												// $("#compatable").append(b)
												// }

													

						})  //.done(function(friends	
}						


	if(userData.gender==2){
			$.ajax({
				   url: currentURL + "/api/friends/boy",
			       method: "GET",
				   context: userData
				   }).done(function(boy) {
				   	console.log("/api/friends/boy")
					   var meArray = userData.scores;
					   var total=0;
							for(i=0;i<userData.scores.length;i++) { 
								total += parseInt(userData.scores[i]); 
							    userData.total=parseInt(total);								             
						    }
		 					    //console.log(userData.total)	
					


							for(i=0; i<boy.length;i++){
								boy[i].sum= boy[i].scores[0]+boy[i].scores[1]+boy[i].scores[2]+boy[i].scores[3]+boy[i].scores[4]+boy[i].scores[5]+boy[i].scores[6]+boy[i].scores[7]+boy[i].scores[8]+boy[i].scores[9];

        						boy[i].difference= userData.total-boy[i].sum;
         							// console.log(userData.total)
                //                  	console.log(friends[0].sum)
                //                     console.log(friends[0].difference)

							              if(boy[i].difference<0){
							                  boy[i].difference= boy[i].difference * -1;
							              }
							              else{
							                  boy[i].difference= boy[i].difference
							              }
							             
							                 // diffy.push(boy[i].difference);
							                 //console.log(friends[i].difference)
							             }   
						             		  boy.sort(function(a, b) {
						              		   return parseFloat(b.difference) - parseFloat(a.difference);
						                        });

						             		  $("#matchName").
						   
						                        console.log(boy);
						   					    $("#h3-about").html(" ");
						   						$("#h4-name").html(" ");
						   						$("#h2-survey").css("text-align","center")
						   						$("#h2-survey").html(userData.name +" here is who you are most compatable with");

						                        $(".entire").css("background-color","lightblue");
						                        $(".entire").css("border","3px solid black");
						                        $("#compatable").css("font-weight","bold");
						                        $("#compatable").css("font-family","cursive");
						                        $("#compatable").css("font-size","24px");
						                        
						                        $("#h2-survey").css("font-weight","bold");
						                       // $("#h2-survey").css("color","sans-serif");
						                        $("#h2-survey").css("font-family","sans-serif");
						                        $("#h2-survey").css("font-size","24px");
						                        $("#compatable").empty()
						                        for(i=0;i<boy.length;i++){
						                        	boy[i].percentage = parseInt(((boy[i].difference)/50)*100) + "%";
						                        	console.log(boy[i].percentage)
						                        	var a = $("<img>");
						                        		a.attr("src", boy[i].photo)
						                        		a.css("width", "330");
						                        		a.css("height", "330")
						                        		a.css("margin", "20px");
						                        		a.css("border","3px solid black")

												var b= $("<div>");
											    b.html("<div class= 'move'>"+ "*** " +boy[i].name+" ***" +"</div> <br>" +"<div class= 'move2'>"+ boy[i].percentage+" compatable" +"</div>");
												console.log(b);
												b.append(a)
												$("#compatable").css("display","flex")
												$("#compatable").append(b)
												}			

					})

				}	//userData.gender==2	
		
		}


	    	
		
		else
		{
			alert("Please fill out all fields before submitting!");
		}
    	
    	return false;

    	
    });

	

$("#reset").on("click", function() {
		document.location.reload();
	 	});
  </script>




</html>